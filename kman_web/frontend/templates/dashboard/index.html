{% extends "base.html" %}

{% block content %}

{% from "form_macros.html" import render_form_errors %}

{{ render_form_errors(form) }}
<style>
    .ui-menu { width: 150px; }
</style>

<!-- wtforms -->
<form method="post" action="{{ url_for('dashboard.index') }}" role="form"
      enctype="multipart/form-data">
{{ form.hidden_tag() }}
<div class="panel panel-default panel-kman" style="width=100%" id ="panel0">
  <div class="panel-title" >
    <div style="margin:10px;padding-top:20px;">
      <span
        class="kman-k">K</span><span class="panel_title_text">nowledge
        Based </span><span
        class="kman-m">M</span><span class="panel_title_text">ultiple
        Sequence </span><span
        class="kman-a">A</span><span class="panel_title_text">lignment
        for </span><span
        class="kman-n">N</span><span class="panel_title_text">atively
        Unfolded Proteins </span>
    </div>
  </div>
  <div class="panel-body">
    <div class="row">
      <div id="sequence_div" class="form-group">
        <div style="margin:10px;">
           {{ form.sequence(class_='form-control',
                            placeholder='Enter a protein sequence',
                            rows="13", style="width: 100%;") }}
        </div>
      </div>
    </div>
  </div>
</div>
<div class="panel panel-default panel-kman" style="width=100%" id ="panel0">
  <div class="panel-body" >
    <div class="row">
      <div id = "gop_div" class="form-group" style="margin:20px;">
        <div class="col-xs-3">{{ form.gap_open_p.label }}</div>
        <div class="col-xs-1">{{ form.gap_open_p(class_='form-control gap-form')}}</div>
        <div class="col-xs-3">{{ form.gap_ext_p.label }}</div>
        <div class="col-xs-1">{{ form.gap_ext_p(class_='form-control gap-form')}}</div>
        <div class="col-xs-3">{{ form.end_gap_p.label }}</div>
        <div class="col-xs-1">{{ form.end_gap_p(class_='form-control gap-form')}}</div>
      </div>
    </div>
    <div class="row">
      <div id = "features_div" class="form-group" style="margin:20px;">
        <div class="col-xs-3">{{ form.ptm_score.label }}</div>
        <div class="col-xs-1">{{ form.ptm_score(class_='form-control gap-form')}}</div>
        <div class="col-xs-3">{{ form.domain_score.label }}</div>
        <div class="col-xs-1">{{ form.domain_score(class_='form-control gap-form')}}</div>
        <div class="col-xs-3">{{ form.motif_score.label }}</div>
        <div class="col-xs-1">{{ form.motif_score(class_='form-control gap-form')}}</div>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-6">
        <div id="output_type_div" class="form-group" style="width=100%;
            height:100%;margin:20px;">
          {{ form.output_type.label }}
          {{ form.output_type(class_='form-control', style="width:300px;") }}
        </div>
      </div>
      <div class="col-xs-6">
        <div id="form_submit_div" class="form-group " style="float:right;
            width=100%; height:100%;margin:30px;padding-top:15px;">
          <button type="submit" name="sequence" class="btn btn-primary">Submit</button>
          <button type="reset" class="btn btn-default">Clear</button>
        </div>
      </div>
    </div>
  </div>
</div>
    
</form>
<br>
{% endblock %}
{% block js %}
<script type="text/javascript">
  function show_sequence_input() {
      $('#sequence_div').removeClass('hidden');
  }
  function show_tour_data_input(index) {
      switch (index) {
      case 3:
        show_sequence_input();
        break;
      }
  }
  function show_data_input() {
      var selected = $('#input_type').children(":selected").attr('value');
      switch (selected) {
      case 'sequence':
        show_sequence_input();
        break;
      }
  }

  $(document).ready( function() {
    // Setup tour
    var tour = new Tour({
      backdrop: true,
      orphan: true,
      storage: false,
      onNext: function (tour) {
        show_tour_data_input(tour.getCurrentStep() + 1)
      },
      onPrev: function (tour) {
        show_tour_data_input(tour.getCurrentStep() - 1)
      },
      onEnd: function (tour) { show_data_input(); },
      steps: [
      {
        element: "",
        title: "Start Tour",
        content: "This tour will walk you through the usage of KMAN." +
                 " Once the tour is complete, you can get started!" +
                 "<br><br>Click next to begin."
      },
      {
        element: "#output_type_div",
        title: "Output Type",
        content: "Select the action to be performed.",
        placement: "right" 
      },
      {
        element: "#sequence_div",
        title: "Sequence",
        placement: "bottom",
      },
      {
        element: "#form_submit_div",
        title: "Submit",
        content: "When you're ready, click <code>Submit</code> to send your " +
                 "request to the server.<br><br>A result page will be shown " +
                 "with the status of your request, and when completed, the " +
                 "output will be shown.",

        placement: "left" 
      }
    ]});
    tour.init();

    $('#start_tour').click(function() { tour.restart(); });

    // Ensure that the input types listed are correct for the selected output
    // type.
    var selected = $('#input_type').children(":selected").attr('value');
    $('#input_type option[value=' + selected + ']').prop('selected', true);
  });
</script>

</script>
{% endblock %}


